<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.53">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dimitri Masson">
<meta name="author" content="Yann Girard">
<meta name="dcterms.date" content="2025-02-03">
<meta name="description" content="visualization of the temperature anomalies in the form of a Joy Division plot.">

<title>Unknown Warming: A joy division inspired plot of Temperature Anomalies – Dimitri Masson</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../assets/favicon_128_128.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="module" src="../../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="../../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/lipis/flag-icons@7.2.3/css/flag-icons.min.css">
<meta property="og:title" content="Unknown Warming: A joy division inspired plot of Temperature Anomalies – Dimitri Masson">
<meta property="og:description" content="visualization of the temperature anomalies in the form of a Joy Division plot.">
<meta property="og:image" content="https://dhmmasson.github.io/projects/DataViz/temperatureAnomalies.png">
<meta property="og:site_name" content="Dimitri Masson">
<meta property="og:locale" content="en_US">
<meta property="og:image:height" content="452">
<meta property="og:image:width" content="802">
<meta name="citation_title" content="Unknown Warming: A joy division inspired plot of Temperature Anomalies">
<meta name="citation_author" content="Dimitri Masson">
<meta name="citation_author" content="Yann Girard">
<meta name="citation_publication_date" content="2025-02-03">
<meta name="citation_cover_date" content="2025-02-03">
<meta name="citation_year" content="2025">
<meta name="citation_online_date" content="2025-02-03">
<meta name="citation_fulltext_html_url" content="https://dhmmasson.github.io/projects/DataViz/temperatureAnomalies.html">
<meta name="citation_language" content="en">
<meta name="citation_journal_title" content="dhmmasson.github.io
">
<meta name="citation_reference" content="citation_title=ERA5 hourly data on single levels from 1940 to present;,citation_author=C3S;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_fulltext_html_url=https://cds.climate.copernicus.eu/doi/10.24381/cds.adbb2d47;,citation_doi=10.24381/CDS.ADBB2D47;,citation_publisher=Copernicus Climate Change Service (C3S) Climate Data Store (CDS);">
<meta name="citation_reference" content="citation_title=2023 confirmed as world’s hottest year on record;,citation_abstract=Climate records tumbled “like dominoes” in 2023, with temperatures far above any recorded level.;,citation_author=Mark Poynting;,citation_author=Erwan Rivault;,citation_publication_date=2024-01-09;,citation_cover_date=2024-01-09;,citation_year=2024;,citation_fulltext_html_url=https://www.bbc.com/news/science-environment-67861954;,citation_language=en-GB;,citation_journal_title=BBC News;">
<meta name="citation_reference" content="citation_title=Copernicus 1850-1900 Baseline – Daily GMST Anomaly - Paris Agreement Temperature Index;,citation_abstract=Deep dive into the 1850-1900 Baseline, so that I can confidently produce graphics which are accurate using the Copernicus ERA5 data. This work has resulted in a change to my graphics in June 2024 onwards, compared to my earlier work in Feb 2024. Terms Abstract I was frustrated that there appeared to be minor inconsistencies;,citation_author= ReesCatOphuls;,citation_publication_date=2024-06-04;,citation_cover_date=2024-06-04;,citation_year=2024;,citation_fulltext_html_url=https://parisagreementtemperatureindex.com/copernicus-1850-1900-baseline-daily-gmst/;,citation_language=en-GB;">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../assets/favicon_128_128.webp" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Dimitri Masson</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Bibliography.html"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/dhmmasson"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/dimitri-masson-a595612b/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.researchgate.net/profile/Dimitri-Masson-2"> <i class="bi bi-ai ai ai-researchgate-square" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#unknown-warming-a-joy-division-inspired-plot-of-temperature-anomalies" id="toc-unknown-warming-a-joy-division-inspired-plot-of-temperature-anomalies" class="nav-link active" data-scroll-target="#unknown-warming-a-joy-division-inspired-plot-of-temperature-anomalies">Unknown Warming: A joy division inspired plot of Temperature Anomalies</a></li>
  <li><a href="#technical-details" id="toc-technical-details" class="nav-link" data-scroll-target="#technical-details">Technical details</a>
  <ul class="collapse">
  <li><a href="#parsing-the-data" id="toc-parsing-the-data" class="nav-link" data-scroll-target="#parsing-the-data">Parsing the data</a></li>
  <li><a href="#data-correction" id="toc-data-correction" class="nav-link" data-scroll-target="#data-correction">Data correction</a></li>
  <li><a href="#grouping-the-anomalies-by-year" id="toc-grouping-the-anomalies-by-year" class="nav-link" data-scroll-target="#grouping-the-anomalies-by-year">Grouping the anomalies by year</a></li>
  <li><a href="#smoothing-the-data-with-a-gaussian-blur" id="toc-smoothing-the-data-with-a-gaussian-blur" class="nav-link" data-scroll-target="#smoothing-the-data-with-a-gaussian-blur">Smoothing the Data with a Gaussian Blur</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Unknown Warming: A joy division inspired plot of Temperature Anomalies</h1>
</div>

<div>
  <div class="description">
    <p>visualization of the temperature anomalies in the form of a Joy Division plot.</p>
  </div>
</div>

<style>
  .quarto-title-banner {
    background-image: linear-gradient(
        180deg,
        rgba(0, 64, 85, 1) 0%,
        rgba(0, 64, 86, 0.9) 50%,
        rgba(0, 64, 85, 0.75) 55%
      ),
      url(./temperatureAnomalies.png);
  }
</style>


<div class="quarto-title-meta column-page-left">
    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
            <p>Dimitri Masson <a href="mailto:d.masson@estia.fr" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0002-7072-3146" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
            <p>Yann Girard </p>
          </div>
  </div>
     <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 3, 2025</p>
    </div>
  </div>
     </div>

<div>
  <div class="abstract">
    <div class="block-title">Abstract</div>
    <p>My friend Yann showed me a cool graph <span class="citation" data-cites="poynting2024_2023Confirmed">(<a href="#ref-poynting2024_2023Confirmed" role="doc-biblioref">Poynting &amp; Rivault, 2024</a>)</span> he wanted to replicate, where temperature anomalies are plotted by frequency rather than chronologically, resembling a Joy Division plot (Inspired by the album cover of Unknown Pleasures by Joy Division), the graph is created by counting the number of days each anomaly occurs per year and offsetting the resulting curve for each year.</p>
    <p>Two transformation are applied to the raw data <span class="citation" data-cites="c3s2018_ERA5Hourly">(<a href="#ref-c3s2018_ERA5Hourly" role="doc-biblioref">C3S, 2018</a>)</span> to enhance its appearance. First anomalies are corrected <span class="citation" data-cites="reescatophuls2024_Copernicus18501900">(<a href="#ref-reescatophuls2024_Copernicus18501900" role="doc-biblioref">ReesCatOphuls, 2024</a>)</span> to correspond to the 1850-1900 Baseline, second a Gaussian blur is applied to smooth out the graph.</p>
    <p>You can play with the parameters to see how the plot changes. The opacity, the scale of the years, the smooth factor, the color, and the option to start the plot from the bottom or to display only the anomalies.</p>
    <p>Below are some technical details on how the data is processed and the plot is generated.</p>
  </div>
</div>
  
</header>


<section id="unknown-warming-a-joy-division-inspired-plot-of-temperature-anomalies" class="level1">
<h1>Unknown Warming: A joy division inspired plot of Temperature Anomalies</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">table</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell" data-fig-attr="Source: ERA5 @c3s2018_ERA5Hourly" data-fig-attr-url="https://cds.climate.copernicus.eu/cdsapp#!/dataset/reanalysis-era5-single-levels?tab=overview">
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="53" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 52;"><span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="co">// Plot using Plot.plot a area chart for each year</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>chart <span class="op">=</span> Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">areaY</span>(</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>        joyData<span class="op">,</span> </span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>        { <span class="dt">x</span><span class="op">:</span> <span class="st">"anomaly"</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>        <span class="op">,</span> <span class="dt">y1</span><span class="op">:</span> <span class="op">!</span>fromBottom <span class="op">?</span> <span class="dv">0</span> <span class="op">:</span> <span class="st">"reference"</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>        <span class="op">,</span> <span class="dt">y2</span><span class="op">:</span> <span class="st">"height"</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>        <span class="op">,</span> <span class="dt">z</span><span class="op">:</span> <span class="st">"year"</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>        <span class="op">,</span> <span class="dt">axisY</span><span class="op">:</span> <span class="kw">null</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>        <span class="op">,</span> <span class="dt">fillOpacity</span><span class="op">:</span> opacity</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>        <span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"white"</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>        <span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> color  })<span class="op">,</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">axisY</span>(<span class="bu">Array</span>(<span class="dv">2025</span><span class="op">-</span><span class="dv">1940</span>)<span class="op">.</span><span class="fu">fill</span>(<span class="dv">1</span>)<span class="op">.</span><span class="fu">map</span>((e<span class="op">,</span>i)<span class="kw">=&gt;</span>(i<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>yearOffset)<span class="op">,</span> {</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="st">"Year"</span><span class="op">,</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>      <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>      <span class="dt">text</span><span class="op">:</span> <span class="bu">Array</span>(<span class="dv">2025</span><span class="op">-</span><span class="dv">1940</span>)<span class="op">.</span><span class="fu">fill</span>(<span class="dv">1</span>)<span class="op">.</span><span class="fu">map</span>((e<span class="op">,</span>i)<span class="kw">=&gt;</span>(<span class="st">""</span><span class="op">+</span>(<span class="dv">2024</span><span class="op">-</span>i)))<span class="op">,</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>      <span class="dt">domain</span><span class="op">:</span> [maxYear<span class="op">,</span> minYear]</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">axisX</span>({</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="st">"Temperature Anomaly"</span><span class="op">,</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>      <span class="dt">interval</span><span class="op">:</span> <span class="fl">0.5</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>    <span class="co">// showZero? Plot.ruleX([0], {stroke: "red", strokeOpacity: 0.5}):null,</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">,</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Temperature Anomaly"</span>}<span class="op">,</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"year"</span>}<span class="op">,</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>  <span class="dt">width</span><span class="op">:</span> <span class="dv">800</span><span class="op">,</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>  <span class="dt">height</span><span class="op">:</span> <span class="dv">1200</span><span class="op">,</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>  <span class="dt">padding</span><span class="op">:</span> <span class="fl">0.1</span><span class="op">,</span></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>  <span class="dt">fill</span><span class="op">:</span> <span class="st">"black"</span><span class="op">,</span></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>  <span class="dt">title</span><span class="op">:</span> <span class="st">"Joy Division Plot of Temperature Anomalies"</span><span class="op">,</span></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-ojs-cell-1" class="cell-output cell-output-display quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ojs-cell-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="ojs-cell-1" data-nodetype="declaration">

</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ojs-cell-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Joy Division Plot of Temperature Anomalies
</figcaption>
</figure>
</div>
</div>
<div class="cell card bg-light p-2 g-col-24 g-col-lg-7">
<div class="sourceCode cell-code hidden" id="cb2" data-startfrom="95" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 94;"><span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>viewof opacity <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span><span class="dv">1</span>]<span class="op">,</span> {<span class="dt">step</span> <span class="op">:</span> <span class="fl">0.1</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fl">0.9</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Opacity"</span>})</span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>viewof yearOffset <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1</span><span class="op">,</span><span class="dv">8</span>]<span class="op">,</span> {<span class="dt">step</span> <span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Y Scale"</span>})</span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a>viewof smoothFactor <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span><span class="dv">4</span>]<span class="op">,</span> {<span class="dt">step</span> <span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Smooth Factor"</span>})</span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a>viewof fromBottom <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">toggle</span>( {<span class="dt">label</span><span class="op">:</span> <span class="st">"wave only"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="kw">false</span>})</span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a>viewof color <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">color</span>( {<span class="dt">label</span><span class="op">:</span> <span class="st">"Color"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"#004055"</span>})</span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a>DOM<span class="op">.</span><span class="fu">download</span>(() <span class="kw">=&gt;</span> <span class="fu">serialize</span>(chart<span class="op">.</span><span class="at">children</span>[<span class="dv">1</span>])<span class="op">,</span> <span class="kw">undefined</span><span class="op">,</span> <span class="st">"Download the SVG"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-6" data-nodetype="expression">

</div>
</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb3" data-startfrom="107" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 106;"><span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> t <span class="kw">=&gt;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">round</span>(t <span class="op">*</span> <span class="dv">100</span>) <span class="op">/</span> <span class="dv">100</span> <span class="op">+</span><span class="st">"°C"</span><span class="op">;</span></span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a>bidimensionalTable <span class="op">=</span> joyData<span class="op">.</span><span class="fu">reduce</span>( (anomalies<span class="op">,</span> d) <span class="kw">=&gt;</span> {</span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (d<span class="op">.</span><span class="at">year</span> <span class="kw">in</span> anomalies) {</span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a>    anomalies[d<span class="op">.</span><span class="at">year</span>][ <span class="fu">temp</span>( d<span class="op">.</span><span class="at">anomaly</span>) ] <span class="op">=</span>d<span class="op">.</span><span class="at">count</span></span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a>    anomalies[d<span class="op">.</span><span class="at">year</span>] <span class="op">=</span> {<span class="dt">year</span><span class="op">:</span> d<span class="op">.</span><span class="at">year</span>} </span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a>    anomalies[d<span class="op">.</span><span class="at">year</span>][<span class="fu">temp</span>( d<span class="op">.</span><span class="at">anomaly</span>) ] <span class="op">=</span> d<span class="op">.</span><span class="at">count</span></span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> anomalies</span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a>}<span class="op">,</span> [])<span class="op">.</span><span class="fu">filter</span>( d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span> <span class="op">&gt;=</span> <span class="dv">1940</span>)</span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">table</span>(bidimensionalTable)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-3" data-nodetype="expression">

</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="technical-details" class="level1">
<h1>Technical details</h1>
<p>In this section, we will provide some technical details on how the data is processed and the plot is generated. The process is roughly divided into three steps: 1. parsing the data the raw data from Copernicus <span class="citation" data-cites="c3s2018_ERA5Hourly">(<a href="#ref-c3s2018_ERA5Hourly" role="doc-biblioref">C3S, 2018</a>)</span> 2. Correcting the anomalies to correspond to the 1850-1900 Baseline 3. Counting the anomalies per year 4. Applying a Gaussian blur to smooth out the graph 5. Offset the curve for each year to produce the Joy Division effect</p>
<section id="parsing-the-data" class="level2">
<h2 class="anchored" data-anchor-id="parsing-the-data">Parsing the data</h2>
<p>We start by downloading the daily global mean near-surface (2m) air temperature from 1940-2024 from the ERA5 data (<span class="citation" data-cites="c3s2018_ERA5Hourly">C3S (<a href="#ref-c3s2018_ERA5Hourly" role="doc-biblioref">2018</a>)</span>) from the <a href="https://cds.climate.copernicus.eu/cdsapp#!/dataset/reanalysis-era5-single-levels?tab=overview">copernicus website</a>. You can access the values used in this visualisation <a href="./era5_daily_series_2t_global.csv">here</a>. One of the tricky thing is that the CSV files contains comments lines (starting with #). D3 doesn’t handle that by default and we need to remove before parsing the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-1" data-startfrom="140" data-source-offset="-21"><pre class="sourceCode js code-annotation-code code-with-copy code-annotated"><code class="sourceCode javascript" style="counter-reset: source-line 139;"><span id="annotated-cell-1-140"><a href="#annotated-cell-1-140" aria-hidden="true" tabindex="-1"></a>rawData <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"./era5_daily_series_2t_global.csv"</span>)<span class="op">.</span><span class="fu">text</span>()<span class="op">.</span><span class="fu">then</span>(processCSV)<span class="op">;</span></span>
<span id="annotated-cell-1-141"><a href="#annotated-cell-1-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-1-142"><a href="#annotated-cell-1-142" aria-hidden="true" tabindex="-1"></a><span class="co">// Function to preprocess and parse the CSV</span></span>
<span id="annotated-cell-1-143"><a href="#annotated-cell-1-143" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">processCSV</span>(content) {</span>
<span id="annotated-cell-1-144"><a href="#annotated-cell-1-144" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Remove comment lines (lines starting with #) </span></span>
<span id="annotated-cell-1-145"><a href="#annotated-cell-1-145" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> lines <span class="op">=</span> content<span class="op">.</span><span class="fu">split</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)<span class="op">;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="1">1</button><span id="annotated-cell-1-146" class="code-annotation-target"><a href="#annotated-cell-1-146" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> filteredLines <span class="op">=</span> lines<span class="op">.</span><span class="fu">filter</span>(line <span class="kw">=&gt;</span> <span class="op">!</span>line<span class="op">.</span><span class="fu">trim</span>()<span class="op">.</span><span class="fu">startsWith</span>(<span class="st">"#"</span>))<span class="op">;</span></span>
<span id="annotated-cell-1-147"><a href="#annotated-cell-1-147" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> csvContent <span class="op">=</span> filteredLines<span class="op">.</span><span class="fu">join</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)<span class="op">;</span></span>
<span id="annotated-cell-1-148"><a href="#annotated-cell-1-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-1-149"><a href="#annotated-cell-1-149" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Parse the CSV content</span></span>
<span id="annotated-cell-1-150"><a href="#annotated-cell-1-150" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> d3<span class="op">.</span><span class="fu">csvParse</span>(csvContent<span class="op">,</span> d3<span class="op">.</span><span class="at">autoType</span>)<span class="op">.</span><span class="fu">map</span>( </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="2">2</button><span id="annotated-cell-1-151" class="code-annotation-target"><a href="#annotated-cell-1-151" aria-hidden="true" tabindex="-1"></a>    d <span class="kw">=&gt;</span> ({ <span class="dt">year</span><span class="op">:</span> d<span class="op">.</span><span class="at">date</span><span class="op">.</span><span class="fu">getFullYear</span>()</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="3">3</button><span id="annotated-cell-1-152" class="code-annotation-target"><a href="#annotated-cell-1-152" aria-hidden="true" tabindex="-1"></a>          <span class="op">,</span> <span class="dt">day</span> <span class="op">:</span> d3<span class="op">.</span><span class="at">timeDay</span><span class="op">.</span><span class="fu">count</span>(d3<span class="op">.</span><span class="fu">timeYear</span>(d<span class="op">.</span><span class="at">date</span>)<span class="op">,</span> d<span class="op">.</span><span class="at">date</span>) <span class="op">+</span> <span class="dv">1</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="4">4</button><span id="annotated-cell-1-153" class="code-annotation-target"><a href="#annotated-cell-1-153" aria-hidden="true" tabindex="-1"></a>          <span class="op">,</span> <span class="dt">anomaly</span><span class="op">:</span> d[<span class="st">"ano_91-20"</span>] })</span>
<span id="annotated-cell-1-154"><a href="#annotated-cell-1-154" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="annotated-cell-1-155"><a href="#annotated-cell-1-155" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="annotated-cell-1-156"><a href="#annotated-cell-1-156" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="5">5</button><span id="annotated-cell-1-157" class="code-annotation-target"><a href="#annotated-cell-1-157" aria-hidden="true" tabindex="-1"></a>maxYear <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(rawData<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span>)</span>
<span id="annotated-cell-1-158"><a href="#annotated-cell-1-158" aria-hidden="true" tabindex="-1"></a>minYear <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(rawData<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span>)</span>
<span id="annotated-cell-1-159"><a href="#annotated-cell-1-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-1-160"><a href="#annotated-cell-1-160" aria-hidden="true" tabindex="-1"></a><span class="co">// Display the parsed data</span></span>
<span id="annotated-cell-1-161"><a href="#annotated-cell-1-161" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">table</span>(rawData)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-1" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="146" data-code-annotation="1">Filter out the comment lines from the CSV content</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="151" data-code-annotation="2">Anomalies will be grouped by year</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="152" data-code-annotation="3">The correction formula (<a href="#eq-method-2" class="quarto-xref">Equation&nbsp;1</a>) needs the day of the year</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="153" data-code-annotation="4">The raw data contains the anomaly relative to the 1991-2020 average</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="157" data-code-annotation="5">Min and max year are kept for the axis of the plot</span>
</dd>
</dl>
</div>
<div id="fig-ojs-cell-4" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ojs-cell-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display">
<div id="fig-ojs-cell-4-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-ojs-cell-4-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="ojs-cell-4-1" data-nodetype="declaration">

</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-ojs-cell-4-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div id="fig-ojs-cell-4-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-ojs-cell-4-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="ojs-cell-4-2" data-nodetype="declaration">

</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-ojs-cell-4-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div id="fig-ojs-cell-4-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-ojs-cell-4-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="ojs-cell-4-3" data-nodetype="declaration">

</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-ojs-cell-4-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c)
</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div id="fig-ojs-cell-4-4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-ojs-cell-4-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="ojs-cell-4-4" data-nodetype="declaration">

</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-ojs-cell-4-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d)
</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div id="fig-ojs-cell-4-5" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-ojs-cell-4-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="ojs-cell-4-5" data-nodetype="expression">

</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-ojs-cell-4-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(e)
</figcaption>
</figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ojs-cell-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Raw Data
</figcaption>
</figure>
</div>
</div>
</section>
<section id="data-correction" class="level2">
<h2 class="anchored" data-anchor-id="data-correction">Data correction</h2>
<p>The anomalies in the dataset are computed on the basis of the 1991-2020 average. The current expectation in term of global warming (Paris,… ) is to compare to the pre-industrial era. <span class="citation" data-cites="reescatophuls2024_Copernicus18501900">ReesCatOphuls (<a href="#ref-reescatophuls2024_Copernicus18501900" role="doc-biblioref">2024</a>)</span> has proposed 3 methods to correct the anomalies to correspond to the 1850-1900 Baseline. In this visualisation we retained the second method (<a href="#eq-method-2" class="quarto-xref">Equation&nbsp;1</a>), that offset the temperature by about <span class="math inline">\(0.88°C\)</span>.</p>
<p><span id="eq-method-2"><span class="math display">\[
\text{corrected} = \text{anomaly} + 0.88°C + 0.05°C \sin\left(\frac{2\pi \times (day - 0.5)}{days}\right) + 0.07°C \cos\left(\frac{2\pi \times (day - 0.5)}{days}\right)
\tag{1}\]</span></span></p>
<p>You can see in <a href="#fig-correction-visualisation" class="quarto-xref">Figure&nbsp;3</a> what the correction is applied depending of the day of the year</p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb4" data-startfrom="184" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 183;"><span id="cb4-184"><a href="#cb4-184" aria-hidden="true" tabindex="-1"></a>correctionData <span class="op">=</span> d3<span class="op">.</span><span class="at">timeDay</span></span>
<span id="cb4-185"><a href="#cb4-185" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">range</span>(<span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2024</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">12</span>)<span class="op">,</span> <span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2025</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">,</span> <span class="dv">1</span>)</span>
<span id="cb4-186"><a href="#cb4-186" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">map</span>( (e<span class="op">,</span>i)<span class="kw">=&gt;</span> (</span>
<span id="cb4-187"><a href="#cb4-187" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">date</span> <span class="op">:</span> e</span>
<span id="cb4-188"><a href="#cb4-188" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="dt">year</span><span class="op">:</span> <span class="dv">2024</span></span>
<span id="cb4-189"><a href="#cb4-189" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="dt">day</span><span class="op">:</span> i <span class="op">+</span> <span class="dv">1</span> </span>
<span id="cb4-190"><a href="#cb4-190" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="dt">correction</span><span class="op">:</span> <span class="fu">correction</span>({<span class="dt">year</span><span class="op">:</span> <span class="dv">2024</span><span class="op">,</span> <span class="dt">day</span><span class="op">:</span> i <span class="op">+</span> <span class="dv">1</span>})</span>
<span id="cb4-191"><a href="#cb4-191" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-192"><a href="#cb4-192" aria-hidden="true" tabindex="-1"></a>  )) </span>
<span id="cb4-193"><a href="#cb4-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-194"><a href="#cb4-194" aria-hidden="true" tabindex="-1"></a><span class="co">// Line plot of the correction by day of the year</span></span>
<span id="cb4-195"><a href="#cb4-195" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>(</span>
<span id="cb4-196"><a href="#cb4-196" aria-hidden="true" tabindex="-1"></a>  { <span class="dt">marks</span><span class="op">:</span> </span>
<span id="cb4-197"><a href="#cb4-197" aria-hidden="true" tabindex="-1"></a>    [ Plot<span class="op">.</span><span class="fu">dot</span>(correctionData<span class="op">,</span> </span>
<span id="cb4-198"><a href="#cb4-198" aria-hidden="true" tabindex="-1"></a>      { <span class="dt">x</span><span class="op">:</span> <span class="st">"date"</span></span>
<span id="cb4-199"><a href="#cb4-199" aria-hidden="true" tabindex="-1"></a>      <span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"correction"</span></span>
<span id="cb4-200"><a href="#cb4-200" aria-hidden="true" tabindex="-1"></a>      <span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"black"</span></span>
<span id="cb4-201"><a href="#cb4-201" aria-hidden="true" tabindex="-1"></a>      <span class="op">,</span> <span class="dt">r</span><span class="op">:</span> <span class="dv">1</span> </span>
<span id="cb4-202"><a href="#cb4-202" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb4-203"><a href="#cb4-203" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="op">.</span><span class="dv">88</span>]<span class="op">,</span> </span>
<span id="cb4-204"><a href="#cb4-204" aria-hidden="true" tabindex="-1"></a>      {<span class="dt">stroke</span><span class="op">:</span> <span class="st">"red"</span></span>
<span id="cb4-205"><a href="#cb4-205" aria-hidden="true" tabindex="-1"></a>      <span class="op">,</span> <span class="dt">strokeOpacity</span><span class="op">:</span> <span class="fl">0.5</span></span>
<span id="cb4-206"><a href="#cb4-206" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb4-207"><a href="#cb4-207" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb4-208"><a href="#cb4-208" aria-hidden="true" tabindex="-1"></a>  <span class="op">,</span> <span class="dt">x</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Day of the year"</span>}</span>
<span id="cb4-209"><a href="#cb4-209" aria-hidden="true" tabindex="-1"></a>  <span class="op">,</span> <span class="dt">y</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Correction"</span>}</span>
<span id="cb4-210"><a href="#cb4-210" aria-hidden="true" tabindex="-1"></a>  <span class="op">,</span> <span class="dt">width</span><span class="op">:</span> <span class="dv">800</span></span>
<span id="cb4-211"><a href="#cb4-211" aria-hidden="true" tabindex="-1"></a>  <span class="op">,</span> <span class="dt">height</span><span class="op">:</span> <span class="dv">400</span></span>
<span id="cb4-212"><a href="#cb4-212" aria-hidden="true" tabindex="-1"></a>  <span class="op">,</span> <span class="dt">padding</span><span class="op">:</span> <span class="fl">0.1</span></span>
<span id="cb4-213"><a href="#cb4-213" aria-hidden="true" tabindex="-1"></a>  })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-correction-visualisation" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-correction-visualisation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display">
<div id="fig-correction-visualisation-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-correction-visualisation-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="ojs-cell-5-1" data-nodetype="declaration">

</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-correction-visualisation-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div id="fig-correction-visualisation-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-correction-visualisation-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="ojs-cell-5-2" data-nodetype="expression">

</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-correction-visualisation-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption>
</figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-correction-visualisation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Visualisation of the temperature correction following the method 2 (<a href="#eq-method-2" class="quarto-xref">Equation&nbsp;1</a>)
</figcaption>
</figure>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-3" data-startfrom="218" data-source-offset="-0"><pre class="sourceCode js code-annotation-code code-with-copy code-annotated"><code class="sourceCode javascript" style="counter-reset: source-line 217;"><span id="annotated-cell-3-218"><a href="#annotated-cell-3-218" aria-hidden="true" tabindex="-1"></a>correction <span class="op">=</span> ({year<span class="op">,</span> day}) <span class="kw">=&gt;</span> {</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="1">1</button><span id="annotated-cell-3-219" class="code-annotation-target"><a href="#annotated-cell-3-219" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> days <span class="op">=</span>  <span class="op">!</span>(year <span class="op">%</span> <span class="dv">4</span>) <span class="op">?</span> <span class="dv">366</span> <span class="op">:</span> <span class="dv">365</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="2">2</button><span id="annotated-cell-3-220" class="code-annotation-target"><a href="#annotated-cell-3-220" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> correction <span class="op">=</span> <span class="fl">0.88</span> <span class="op">+</span> <span class="fl">0.05</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>((<span class="dv">2</span><span class="op">*</span><span class="fl">3.14159</span> <span class="op">*</span> (day <span class="op">-</span> <span class="fl">0.5</span>)) <span class="op">/</span> days)</span>
<span id="annotated-cell-3-221"><a href="#annotated-cell-3-221" aria-hidden="true" tabindex="-1"></a>                            <span class="op">+</span> <span class="fl">0.07</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>((<span class="dv">2</span><span class="op">*</span><span class="fl">3.14159</span> <span class="op">*</span> (day <span class="op">-</span> <span class="fl">0.5</span>)) <span class="op">/</span> days) </span>
<span id="annotated-cell-3-222"><a href="#annotated-cell-3-222" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>( <span class="dv">100</span> <span class="op">*</span> correction ) <span class="op">/</span> <span class="dv">100</span></span>
<span id="annotated-cell-3-223"><a href="#annotated-cell-3-223" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="annotated-cell-3-224"><a href="#annotated-cell-3-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-3-225"><a href="#annotated-cell-3-225" aria-hidden="true" tabindex="-1"></a>correctedData <span class="op">=</span> rawData<span class="op">.</span><span class="fu">map</span>( </span>
<span id="annotated-cell-3-226"><a href="#annotated-cell-3-226" aria-hidden="true" tabindex="-1"></a>    d <span class="kw">=&gt;</span> (</span>
<span id="annotated-cell-3-227"><a href="#annotated-cell-3-227" aria-hidden="true" tabindex="-1"></a>        { <span class="dt">year</span><span class="op">:</span>  d<span class="op">.</span><span class="at">year</span></span>
<span id="annotated-cell-3-228"><a href="#annotated-cell-3-228" aria-hidden="true" tabindex="-1"></a>        <span class="op">,</span> <span class="dt">anomaly</span><span class="op">:</span> d<span class="op">.</span><span class="at">anomaly</span></span>
<span id="annotated-cell-3-229"><a href="#annotated-cell-3-229" aria-hidden="true" tabindex="-1"></a>        <span class="op">,</span> <span class="dt">corrected</span> <span class="op">:</span> d<span class="op">.</span><span class="at">anomaly</span> <span class="op">+</span> <span class="fu">correction</span>(d) } ))</span>
<span id="annotated-cell-3-230"><a href="#annotated-cell-3-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-3-231"><a href="#annotated-cell-3-231" aria-hidden="true" tabindex="-1"></a><span class="co">// Keep the min and max for discretization later on</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="3">3</button><span id="annotated-cell-3-232" class="code-annotation-target"><a href="#annotated-cell-3-232" aria-hidden="true" tabindex="-1"></a>offset <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="annotated-cell-3-233"><a href="#annotated-cell-3-233" aria-hidden="true" tabindex="-1"></a>minAnomaly <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(correctedData<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">corrected</span>) <span class="op">-</span> offset</span>
<span id="annotated-cell-3-234"><a href="#annotated-cell-3-234" aria-hidden="true" tabindex="-1"></a>maxAnomaly <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(correctedData<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">corrected</span>) <span class="op">+</span> offset</span>
<span id="annotated-cell-3-235"><a href="#annotated-cell-3-235" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">table</span>(correctedData)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-3" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="219" data-code-annotation="1">Checking if the year is a leap year, straight forward calculation between 1940 and 2024</span>
</dd>
<dt data-target-cell="annotated-cell-3" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="220" data-code-annotation="2">Formula 2 from <span class="citation" data-cites="reescatophuls2024_Copernicus18501900">ReesCatOphuls (<a href="#ref-reescatophuls2024_Copernicus18501900" role="doc-biblioref">2024</a>)</span> is used correct the anomalies to 1850-1900 baseline temperature</span>
</dd>
<dt data-target-cell="annotated-cell-3" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="232" data-code-annotation="3">The offset is used in the discretization of the anomalies to get an empty bin for the first and last interval</span>
</dd>
</dl>
</div>
<div id="fig-ojs-cell-6" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ojs-cell-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display">
<div id="fig-ojs-cell-6-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-ojs-cell-6-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="ojs-cell-6-1" data-nodetype="declaration">

</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-ojs-cell-6-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div id="fig-ojs-cell-6-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-ojs-cell-6-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="ojs-cell-6-2" data-nodetype="declaration">

</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-ojs-cell-6-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div id="fig-ojs-cell-6-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-ojs-cell-6-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="ojs-cell-6-3" data-nodetype="declaration">

</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-ojs-cell-6-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c)
</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div id="fig-ojs-cell-6-4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-ojs-cell-6-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="ojs-cell-6-4" data-nodetype="declaration">

</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-ojs-cell-6-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d)
</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div id="fig-ojs-cell-6-5" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-ojs-cell-6-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="ojs-cell-6-5" data-nodetype="declaration">

</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-ojs-cell-6-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(e)
</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div id="fig-ojs-cell-6-6" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-ojs-cell-6-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="ojs-cell-6-6" data-nodetype="expression">

</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-ojs-cell-6-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(f)
</figcaption>
</figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ojs-cell-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Corrected Data
</figcaption>
</figure>
</div>
</div>
</section>
<section id="grouping-the-anomalies-by-year" class="level2">
<h2 class="anchored" data-anchor-id="grouping-the-anomalies-by-year">Grouping the anomalies by year</h2>
<p>For each year we count the number of anomalies for each temperature anomaly. The anomalies are discretized into 0.1 intervals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-4" data-startfrom="248" data-source-offset="-0"><pre class="sourceCode js code-annotation-code code-with-copy code-annotated"><code class="sourceCode javascript" style="counter-reset: source-line 247;"><span id="annotated-cell-4-248"><a href="#annotated-cell-4-248" aria-hidden="true" tabindex="-1"></a>length <span class="op">=</span> (maxAnomaly <span class="op">-</span> minAnomaly) <span class="op">*</span> <span class="dv">100</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="1">1</button><span id="annotated-cell-4-249" class="code-annotation-target"><a href="#annotated-cell-4-249" aria-hidden="true" tabindex="-1"></a>indexF <span class="op">=</span> (x) <span class="kw">=&gt;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">round</span>((x <span class="op">-</span> minAnomaly) <span class="op">*</span> <span class="dv">100</span>)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="2">2</button><span id="annotated-cell-4-250" class="code-annotation-target"><a href="#annotated-cell-4-250" aria-hidden="true" tabindex="-1"></a>indexF_1 <span class="op">=</span> (x) <span class="kw">=&gt;</span> (x <span class="op">/</span> <span class="dv">100</span>) <span class="op">+</span> minAnomaly</span>
<span id="annotated-cell-4-251"><a href="#annotated-cell-4-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-4-252"><a href="#annotated-cell-4-252" aria-hidden="true" tabindex="-1"></a>anomalies <span class="op">=</span> correctedData<span class="op">.</span><span class="fu">reduce</span>((anomalies<span class="op">,</span> d) <span class="kw">=&gt;</span> {</span>
<span id="annotated-cell-4-253"><a href="#annotated-cell-4-253" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (d<span class="op">.</span><span class="at">year</span> <span class="kw">in</span> anomalies) {</span>
<span id="annotated-cell-4-254"><a href="#annotated-cell-4-254" aria-hidden="true" tabindex="-1"></a>      anomalies[d<span class="op">.</span><span class="at">year</span>][<span class="fu">indexF</span>(d<span class="op">.</span><span class="at">corrected</span>)] <span class="op">+=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="annotated-cell-4-255"><a href="#annotated-cell-4-255" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="annotated-cell-4-256"><a href="#annotated-cell-4-256" aria-hidden="true" tabindex="-1"></a>      anomalies[d<span class="op">.</span><span class="at">year</span>] <span class="op">=</span> <span class="bu">Array</span>(length)<span class="op">.</span><span class="fu">fill</span>(<span class="dv">0</span>)<span class="op">;</span></span>
<span id="annotated-cell-4-257"><a href="#annotated-cell-4-257" aria-hidden="true" tabindex="-1"></a>      anomalies[d<span class="op">.</span><span class="at">year</span>][<span class="fu">indexF</span>(d<span class="op">.</span><span class="at">corrected</span>)] <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="annotated-cell-4-258"><a href="#annotated-cell-4-258" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="annotated-cell-4-259"><a href="#annotated-cell-4-259" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> anomalies<span class="op">;</span></span>
<span id="annotated-cell-4-260"><a href="#annotated-cell-4-260" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span> [])<span class="op">;</span></span>
<span id="annotated-cell-4-261"><a href="#annotated-cell-4-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-4-262"><a href="#annotated-cell-4-262" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">table</span>(anomalies<span class="op">.</span><span class="fu">filter</span>( (e<span class="op">,</span>i) <span class="kw">=&gt;</span> i <span class="op">&gt;=</span> <span class="dv">1940</span>))</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-4" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="249" data-code-annotation="1">The indexF function is used to discretize the anomalies into 0.1 intervals</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="250" data-code-annotation="2">The indexF_1 function is used to get back the original value from the discretized value</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-5" data-nodetype="expression">

</div>
</div>
</div>
</div>
</section>
<section id="smoothing-the-data-with-a-gaussian-blur" class="level2">
<h2 class="anchored" data-anchor-id="smoothing-the-data-with-a-gaussian-blur">Smoothing the Data with a Gaussian Blur</h2>
<p>To smooth the data we apply a Gaussian blur to the anomaly count by computing a weighted average neighboring cells. The kernels are precomputed for 5 different sizes of blur using a binomial distribution. Only the positive side of the kernel for simplicity. You can visualize the kernels in <a href="#fig-kernel-visualization" class="quarto-xref">Figure&nbsp;5</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" data-startfrom="271" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 270;"><span id="cb5-271"><a href="#cb5-271" aria-hidden="true" tabindex="-1"></a>kernels <span class="op">=</span> [</span>
<span id="cb5-272"><a href="#cb5-272" aria-hidden="true" tabindex="-1"></a>      [<span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb5-273"><a href="#cb5-273" aria-hidden="true" tabindex="-1"></a>      [<span class="dv">2</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb5-274"><a href="#cb5-274" aria-hidden="true" tabindex="-1"></a>      [<span class="dv">6</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb5-275"><a href="#cb5-275" aria-hidden="true" tabindex="-1"></a>      [<span class="dv">20</span><span class="op">,</span> <span class="dv">15</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb5-276"><a href="#cb5-276" aria-hidden="true" tabindex="-1"></a>      [<span class="dv">70</span><span class="op">,</span> <span class="dv">56</span><span class="op">,</span> <span class="dv">28</span><span class="op">,</span> <span class="dv">8</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb5-277"><a href="#cb5-277" aria-hidden="true" tabindex="-1"></a>    ]<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb6" data-startfrom="285" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 284;"><span id="cb6-285"><a href="#cb6-285" aria-hidden="true" tabindex="-1"></a>kernelVisu <span class="op">=</span> kernels<span class="op">.</span><span class="fu">flatMap</span>( (kernel<span class="op">,</span> i) <span class="kw">=&gt;</span> </span>
<span id="cb6-286"><a href="#cb6-286" aria-hidden="true" tabindex="-1"></a>      kernel<span class="op">.</span><span class="fu">flatMap</span>( (e<span class="op">,</span> j) <span class="kw">=&gt;</span> (j <span class="op">==</span> <span class="dv">0</span>)<span class="op">?</span> <span class="bu">Array</span>(e)<span class="op">.</span><span class="fu">fill</span>( {i<span class="op">,</span> j } ) <span class="op">:</span> <span class="bu">Array</span>(e)<span class="op">.</span><span class="fu">fill</span>( [{i<span class="op">,</span> j }<span class="op">,</span> {i<span class="op">,</span> <span class="dt">j</span><span class="op">:</span> <span class="op">-</span>j} ]) ) )</span>
<span id="cb6-287"><a href="#cb6-287" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">flat</span>()</span>
<span id="cb6-288"><a href="#cb6-288" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-289"><a href="#cb6-289" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({ </span>
<span id="cb6-290"><a href="#cb6-290" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb6-291"><a href="#cb6-291" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">barY</span>(kernelVisu<span class="op">,</span> </span>
<span id="cb6-292"><a href="#cb6-292" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">binX</span>({<span class="dt">y</span><span class="op">:</span> <span class="st">"proportion-facet"</span>}<span class="op">,</span> </span>
<span id="cb6-293"><a href="#cb6-293" aria-hidden="true" tabindex="-1"></a>        { <span class="dt">x</span><span class="op">:</span> <span class="st">"j"</span></span>
<span id="cb6-294"><a href="#cb6-294" aria-hidden="true" tabindex="-1"></a>        <span class="op">,</span> <span class="dt">fx</span><span class="op">:</span> <span class="st">"i"</span></span>
<span id="cb6-295"><a href="#cb6-295" aria-hidden="true" tabindex="-1"></a>        <span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"black"</span></span>
<span id="cb6-296"><a href="#cb6-296" aria-hidden="true" tabindex="-1"></a>        <span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"black"</span>}))</span>
<span id="cb6-297"><a href="#cb6-297" aria-hidden="true" tabindex="-1"></a>      <span class="op">,</span> Plot<span class="op">.</span><span class="fu">axisY</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"Weight"</span><span class="op">,</span> <span class="dt">tickFormat</span><span class="op">:</span> <span class="st">"%"</span>})</span>
<span id="cb6-298"><a href="#cb6-298" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb6-299"><a href="#cb6-299" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb6-300"><a href="#cb6-300" aria-hidden="true" tabindex="-1"></a>  <span class="op">,</span> <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb6-301"><a href="#cb6-301" aria-hidden="true" tabindex="-1"></a>  <span class="op">,</span> <span class="dt">x</span><span class="op">:</span></span>
<span id="cb6-302"><a href="#cb6-302" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">tickFormat</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> d <span class="op">==</span> <span class="dv">0</span> <span class="op">?</span> <span class="st">"0"</span> <span class="op">:</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>( <span class="op">+</span>d)</span>
<span id="cb6-303"><a href="#cb6-303" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Kernel Offset"</span>}</span>
<span id="cb6-304"><a href="#cb6-304" aria-hidden="true" tabindex="-1"></a>  <span class="op">,</span> <span class="dt">fx</span><span class="op">:</span> </span>
<span id="cb6-305"><a href="#cb6-305" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">label</span><span class="op">:</span> <span class="st">"Kernel Size"</span></span>
<span id="cb6-306"><a href="#cb6-306" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="dt">anchor</span><span class="op">:</span> <span class="st">"bottom"</span></span>
<span id="cb6-307"><a href="#cb6-307" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-308"><a href="#cb6-308" aria-hidden="true" tabindex="-1"></a>  <span class="op">,</span> <span class="dt">y</span><span class="op">:</span> </span>
<span id="cb6-309"><a href="#cb6-309" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">inset</span><span class="op">:</span> <span class="dv">5</span></span>
<span id="cb6-310"><a href="#cb6-310" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Weight"</span></span>
<span id="cb6-311"><a href="#cb6-311" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="dt">tickFormat</span><span class="op">:</span> <span class="st">"%"</span></span>
<span id="cb6-312"><a href="#cb6-312" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-313"><a href="#cb6-313" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-kernel-visualization" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-kernel-visualization-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display">
<div id="fig-kernel-visualization-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-kernel-visualization-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="ojs-cell-9-1" data-nodetype="declaration">

</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-kernel-visualization-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div id="fig-kernel-visualization-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-kernel-visualization-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="ojs-cell-9-2" data-nodetype="expression">

</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-kernel-visualization-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption>
</figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-kernel-visualization-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Kernel Visualization
</figcaption>
</figure>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-7" data-startfrom="318" data-source-offset="-0"><pre class="sourceCode js code-annotation-code code-with-copy code-annotated"><code class="sourceCode javascript" style="counter-reset: source-line 317;"><span id="annotated-cell-7-318"><a href="#annotated-cell-7-318" aria-hidden="true" tabindex="-1"></a>joyData <span class="op">=</span>  {</span>
<span id="annotated-cell-7-319"><a href="#annotated-cell-7-319" aria-hidden="true" tabindex="-1"></a>  <span class="co">//  Gaussian Blur smoothing </span></span>
<span id="annotated-cell-7-320"><a href="#annotated-cell-7-320" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> joyData <span class="op">=</span> []<span class="op">;</span></span>
<span id="annotated-cell-7-321"><a href="#annotated-cell-7-321" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">let</span> year <span class="kw">in</span> anomalies) { </span>
<span id="annotated-cell-7-322"><a href="#annotated-cell-7-322" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> kernel <span class="op">=</span> kernels[smoothFactor]<span class="op">;</span></span>
<span id="annotated-cell-7-323"><a href="#annotated-cell-7-323" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> length<span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="annotated-cell-7-324"><a href="#annotated-cell-7-324" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> result <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="annotated-cell-7-325"><a href="#annotated-cell-7-325" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> weight <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="annotated-cell-7-326"><a href="#annotated-cell-7-326" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (<span class="kw">let</span> j <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> kernel<span class="op">.</span><span class="at">length</span><span class="op">;</span> j <span class="op">&lt;</span> kernel<span class="op">.</span><span class="at">length</span><span class="op">;</span> j<span class="op">++</span>) {</span>
<span id="annotated-cell-7-327"><a href="#annotated-cell-7-327" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (i <span class="op">+</span> j <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> i <span class="op">+</span> j <span class="op">&lt;</span> length) {</span>
<span id="annotated-cell-7-328"><a href="#annotated-cell-7-328" aria-hidden="true" tabindex="-1"></a>          <span class="kw">const</span> absJ <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>(j)<span class="op">;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="1">1</button><span id="annotated-cell-7-329" class="code-annotation-target"><a href="#annotated-cell-7-329" aria-hidden="true" tabindex="-1"></a>          result <span class="op">+=</span> anomalies[year][i <span class="op">+</span> j] <span class="op">*</span> kernel[absJ]<span class="op">;</span></span>
<span id="annotated-cell-7-330"><a href="#annotated-cell-7-330" aria-hidden="true" tabindex="-1"></a>          weight <span class="op">+=</span> kernel[absJ]<span class="op">;</span></span>
<span id="annotated-cell-7-331"><a href="#annotated-cell-7-331" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="annotated-cell-7-332"><a href="#annotated-cell-7-332" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="annotated-cell-7-333"><a href="#annotated-cell-7-333" aria-hidden="true" tabindex="-1"></a>      joyData<span class="op">.</span><span class="fu">push</span>({ </span>
<span id="annotated-cell-7-334"><a href="#annotated-cell-7-334" aria-hidden="true" tabindex="-1"></a>        <span class="dt">year</span><span class="op">:</span> year<span class="op">,</span></span>
<span id="annotated-cell-7-335"><a href="#annotated-cell-7-335" aria-hidden="true" tabindex="-1"></a>        <span class="dt">anomaly</span><span class="op">:</span> <span class="fu">indexF_1</span>(i)<span class="op">,</span> </span>
<span id="annotated-cell-7-336"><a href="#annotated-cell-7-336" aria-hidden="true" tabindex="-1"></a>        <span class="dt">count</span><span class="op">:</span> result <span class="op">/</span> weight<span class="op">,</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="2">2</button><span id="annotated-cell-7-337" class="code-annotation-target"><a href="#annotated-cell-7-337" aria-hidden="true" tabindex="-1"></a>        <span class="dt">height</span><span class="op">:</span> result <span class="op">/</span> weight <span class="op">+</span> (maxYear <span class="op">-</span> year) <span class="op">*</span> yearOffset<span class="op">,</span></span>
<span id="annotated-cell-7-338"><a href="#annotated-cell-7-338" aria-hidden="true" tabindex="-1"></a>        <span class="dt">reference</span><span class="op">:</span> (maxYear <span class="op">-</span> year) <span class="op">*</span> yearOffset<span class="op">,</span></span>
<span id="annotated-cell-7-339"><a href="#annotated-cell-7-339" aria-hidden="true" tabindex="-1"></a>      })<span class="op">;</span></span>
<span id="annotated-cell-7-340"><a href="#annotated-cell-7-340" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="annotated-cell-7-341"><a href="#annotated-cell-7-341" aria-hidden="true" tabindex="-1"></a>  }</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="3">3</button><span id="annotated-cell-7-342" class="code-annotation-target"><a href="#annotated-cell-7-342" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> joyData<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span> <span class="op">!=</span> maxYear)<span class="op">;</span></span>
<span id="annotated-cell-7-343"><a href="#annotated-cell-7-343" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="annotated-cell-7-344"><a href="#annotated-cell-7-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-7-345"><a href="#annotated-cell-7-345" aria-hidden="true" tabindex="-1"></a>joyData</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-7" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="329" data-code-annotation="1">From one of 5 kernels for gaussian blur of size 1, 2, 3, 4 and 5.</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="337" data-code-annotation="2">To obtain the Joy Division Plot effect the height the count is offseted by the year (reversed so that 2024 is at the bottom)</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="342" data-code-annotation="3">2025 is removed from the data as it is not complete</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-10-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-10-2" data-nodetype="expression">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb7" data-startfrom="354" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 353;"><span id="cb7-354"><a href="#cb7-354" aria-hidden="true" tabindex="-1"></a>serialize <span class="op">=</span> {</span>
<span id="cb7-355"><a href="#cb7-355" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xmlns <span class="op">=</span> <span class="st">"http://www.w3.org/2000/xmlns/"</span><span class="op">;</span></span>
<span id="cb7-356"><a href="#cb7-356" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xlinkns <span class="op">=</span> <span class="st">"http://www.w3.org/1999/xlink"</span><span class="op">;</span></span>
<span id="cb7-357"><a href="#cb7-357" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svgns <span class="op">=</span> <span class="st">"http://www.w3.org/2000/svg"</span><span class="op">;</span></span>
<span id="cb7-358"><a href="#cb7-358" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">function</span> <span class="fu">serialize</span>(svg) {</span>
<span id="cb7-359"><a href="#cb7-359" aria-hidden="true" tabindex="-1"></a>    svg <span class="op">=</span> svg<span class="op">.</span><span class="fu">cloneNode</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb7-360"><a href="#cb7-360" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> fragment <span class="op">=</span> <span class="bu">window</span><span class="op">.</span><span class="at">location</span><span class="op">.</span><span class="at">href</span> <span class="op">+</span> <span class="st">"#"</span><span class="op">;</span></span>
<span id="cb7-361"><a href="#cb7-361" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> walker <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createTreeWalker</span>(svg<span class="op">,</span> <span class="bu">NodeFilter</span><span class="op">.</span><span class="at">SHOW_ELEMENT</span>)<span class="op">;</span></span>
<span id="cb7-362"><a href="#cb7-362" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> (walker<span class="op">.</span><span class="fu">nextNode</span>()) {</span>
<span id="cb7-363"><a href="#cb7-363" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (<span class="kw">const</span> attr <span class="kw">of</span> walker<span class="op">.</span><span class="at">currentNode</span><span class="op">.</span><span class="at">attributes</span>) {</span>
<span id="cb7-364"><a href="#cb7-364" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (attr<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">includes</span>(fragment)) {</span>
<span id="cb7-365"><a href="#cb7-365" aria-hidden="true" tabindex="-1"></a>          attr<span class="op">.</span><span class="at">value</span> <span class="op">=</span> attr<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">replace</span>(fragment<span class="op">,</span> <span class="st">"#"</span>)<span class="op">;</span></span>
<span id="cb7-366"><a href="#cb7-366" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb7-367"><a href="#cb7-367" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb7-368"><a href="#cb7-368" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-369"><a href="#cb7-369" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">setAttributeNS</span>(xmlns<span class="op">,</span> <span class="st">"xmlns"</span><span class="op">,</span> svgns)<span class="op">;</span></span>
<span id="cb7-370"><a href="#cb7-370" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">setAttributeNS</span>(xmlns<span class="op">,</span> <span class="st">"xmlns:xlink"</span><span class="op">,</span> xlinkns)<span class="op">;</span></span>
<span id="cb7-371"><a href="#cb7-371" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> serializer <span class="op">=</span> <span class="kw">new</span> <span class="bu">window</span><span class="op">.</span><span class="at">XMLSerializer</span><span class="op">;</span></span>
<span id="cb7-372"><a href="#cb7-372" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> string <span class="op">=</span> serializer<span class="op">.</span><span class="fu">serializeToString</span>(svg)<span class="op">;</span></span>
<span id="cb7-373"><a href="#cb7-373" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">new</span> <span class="bu">Blob</span>([string]<span class="op">,</span> {<span class="dt">type</span><span class="op">:</span> <span class="st">"image/svg+xml"</span>})<span class="op">;</span></span>
<span id="cb7-374"><a href="#cb7-374" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb7-375"><a href="#cb7-375" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-11" data-nodetype="declaration">

</div>
</div>
</div>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-c3s2018_ERA5Hourly" class="csl-entry" role="listitem">
C3S. (2018). <em>ERA5 hourly data on single levels from 1940 to present</em> [Dataset]. Copernicus Climate Change Service (C3S) Climate Data Store (CDS). <a href="https://doi.org/10.24381/CDS.ADBB2D47">https://doi.org/10.24381/CDS.ADBB2D47</a>
</div>
<div id="ref-poynting2024_2023Confirmed" class="csl-entry" role="listitem">
Poynting, M., &amp; Rivault, E. (2024, January 9). 2023 confirmed as world’s hottest year on record. <em>BBC News</em>. <a href="https://www.bbc.com/news/science-environment-67861954">https://www.bbc.com/news/science-environment-67861954</a>
</div>
<div id="ref-reescatophuls2024_Copernicus18501900" class="csl-entry" role="listitem">
ReesCatOphuls. (2024, June 4). <em>Copernicus 1850-1900 Baseline – Daily GMST Anomaly - Paris Agreement Temperature Index</em>. <a href="https://parisagreementtemperatureindex.com/copernicus-1850-1900-baseline-daily-gmst/">https://parisagreementtemperatureindex.com/copernicus-1850-1900-baseline-daily-gmst/</a>
</div>
</div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@misc{masson2025_UnknownWarming,
  author = {Masson, Dimitri and Girard, Yann},
  title = {Unknown {Warming:} {A} Joy Division Inspired Plot of
    {Temperature} {Anomalies}},
  date = {2025-02-03},
  url = {https://dhmmasson.github.io/projects/DataViz/temperatureAnomalies.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-masson2025_UnknownWarming" class="csl-entry quarto-appendix-citeas" role="listitem">
Masson, D., &amp; Girard, Y. (2025, February 3). Unknown Warming: A joy
division inspired plot of Temperature Anomalies. <em>Dhmmasson.github.io
</em>. <a href="https://dhmmasson.github.io/projects/DataViz/temperatureAnomalies.html">https://dhmmasson.github.io/projects/DataViz/temperatureAnomalies.html</a>
</div></div></section></div></main> <!-- /main -->
<script>
  /**
   * Quarto Hover effect of citations expect the data-cites attribute to be on the parent element of the link with the role doc-biblioref
   * when writing [@citation](url/to/full/citation) in markdown, Obsidian will render it as a link with the data-cites attribute on a span element inside the link
   * This script moves the data-cites attribute to the parent element of the link
   * @author @dhmmasson
   * @version 1.0
   * @license MIT
   */
  window.document.addEventListener("DOMContentLoaded", () => {
    // Find the links that contains an element with the data-cites attribute
    const bibliorefs = window.document.querySelectorAll("a [data-cites]");
    bibliorefs.forEach((biblioref) => {
      const reference = biblioref.getAttribute("data-cites");
      const a = biblioref.closest("a");
      // Add the role to the link
      a.setAttribute("role", "doc-biblioref");
      // Move the data-cites up to the parent element as it is were quarto expects it
      a.parentElement.setAttribute("data-cites", reference);
    });
    console.log("first");
  });
</script>
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IlxuLy8gUGxvdCB1c2luZyBQbG90LnBsb3QgYSBhcmVhIGNoYXJ0IGZvciBlYWNoIHllYXJcbmNoYXJ0ID0gUGxvdC5wbG90KHtcbiAgbWFya3M6IFtcbiAgICBQbG90LmFyZWFZKFxuICAgICAgICBqb3lEYXRhLCBcbiAgICAgICAgeyB4OiBcImFub21hbHlcIlxuICAgICAgICAsIHkxOiAhZnJvbUJvdHRvbSA/IDAgOiBcInJlZmVyZW5jZVwiXG4gICAgICAgICwgeTI6IFwiaGVpZ2h0XCJcbiAgICAgICAgLCB6OiBcInllYXJcIlxuICAgICAgICAsIGF4aXNZOiBudWxsXG4gICAgICAgICwgZmlsbE9wYWNpdHk6IG9wYWNpdHlcbiAgICAgICAgLCBzdHJva2U6IFwid2hpdGVcIlxuICAgICAgICAsIGZpbGw6IGNvbG9yICB9KSxcblxuICAgIFBsb3QuYXhpc1koQXJyYXkoMjAyNS0xOTQwKS5maWxsKDEpLm1hcCgoZSxpKT0+KGkrMSkqeWVhck9mZnNldCksIHtcbiAgICAgIGxhYmVsOiBcIlllYXJcIixcbiAgICAgIGdyaWQ6IHRydWUsXG4gICAgICB0ZXh0OiBBcnJheSgyMDI1LTE5NDApLmZpbGwoMSkubWFwKChlLGkpPT4oXCJcIisoMjAyNC1pKSkpLFxuICAgICAgZG9tYWluOiBbbWF4WWVhciwgbWluWWVhcl1cbiAgICB9KSxcbiAgICBQbG90LmF4aXNYKHtcbiAgICAgIGxhYmVsOiBcIlRlbXBlcmF0dXJlIEFub21hbHlcIixcbiAgICAgIGludGVydmFsOiAwLjVcbiAgICB9KSxcbiAgICAvLyBzaG93WmVybz8gUGxvdC5ydWxlWChbMF0sIHtzdHJva2U6IFwicmVkXCIsIHN0cm9rZU9wYWNpdHk6IDAuNX0pOm51bGwsXG4gIF0sXG4gIHg6IHtsYWJlbDogXCJUZW1wZXJhdHVyZSBBbm9tYWx5XCJ9LFxuICB5OiB7bGFiZWw6IFwieWVhclwifSxcbiAgXG4gIHdpZHRoOiA4MDAsXG4gIGhlaWdodDogMTIwMCxcbiAgcGFkZGluZzogMC4xLFxuICBmaWxsOiBcImJsYWNrXCIsXG4gIHRpdGxlOiBcIkpveSBEaXZpc2lvbiBQbG90IG9mIFRlbXBlcmF0dXJlIEFub21hbGllc1wiLFxufSlcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBvcGFjaXR5ID0gSW5wdXRzLnJhbmdlKFswLDFdLCB7c3RlcCA6IDAuMSwgdmFsdWU6IDAuOSwgbGFiZWw6IFwiT3BhY2l0eVwifSlcbnZpZXdvZiB5ZWFyT2Zmc2V0ID0gSW5wdXRzLnJhbmdlKFsxLDhdLCB7c3RlcCA6IDEsIHZhbHVlOiAyLCBsYWJlbDogXCJZIFNjYWxlXCJ9KVxudmlld29mIHNtb290aEZhY3RvciA9IElucHV0cy5yYW5nZShbMCw0XSwge3N0ZXAgOiAxLCB2YWx1ZTogMywgbGFiZWw6IFwiU21vb3RoIEZhY3RvclwifSlcbnZpZXdvZiBmcm9tQm90dG9tID0gSW5wdXRzLnRvZ2dsZSgge2xhYmVsOiBcIndhdmUgb25seVwiLCB2YWx1ZTogZmFsc2V9KVxudmlld29mIGNvbG9yID0gSW5wdXRzLmNvbG9yKCB7bGFiZWw6IFwiQ29sb3JcIiwgdmFsdWU6IFwiIzAwNDA1NVwifSlcblxuRE9NLmRvd25sb2FkKCgpID0+IHNlcmlhbGl6ZShjaGFydC5jaGlsZHJlblsxXSksIHVuZGVmaW5lZCwgXCJEb3dubG9hZCB0aGUgU1ZHXCIpXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTMiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ0ZW1wID0gdCA9PiBNYXRoLnJvdW5kKHQgKiAxMDApIC8gMTAwICtcIsKwQ1wiO1xuYmlkaW1lbnNpb25hbFRhYmxlID0gam95RGF0YS5yZWR1Y2UoIChhbm9tYWxpZXMsIGQpID0+IHtcbiAgXG4gIGlmIChkLnllYXIgaW4gYW5vbWFsaWVzKSB7XG4gICAgYW5vbWFsaWVzW2QueWVhcl1bIHRlbXAoIGQuYW5vbWFseSkgXSA9ZC5jb3VudFxuICB9IGVsc2Uge1xuICAgIGFub21hbGllc1tkLnllYXJdID0ge3llYXI6IGQueWVhcn0gXG4gICAgYW5vbWFsaWVzW2QueWVhcl1bdGVtcCggZC5hbm9tYWx5KSBdID0gZC5jb3VudFxuICB9XG4gIHJldHVybiBhbm9tYWxpZXNcbn0sIFtdKS5maWx0ZXIoIGQgPT4gZC55ZWFyID49IDE5NDApXG5JbnB1dHMudGFibGUoYmlkaW1lbnNpb25hbFRhYmxlKVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC00IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiLy8gTG9hZCB0aGUgQ1NWIGZpbGVcbnJhd0RhdGEgPSBGaWxlQXR0YWNobWVudChcIi4vZXJhNV9kYWlseV9zZXJpZXNfMnRfZ2xvYmFsLmNzdlwiKS50ZXh0KCkudGhlbihwcm9jZXNzQ1NWKTtcblxuLy8gRnVuY3Rpb24gdG8gcHJlcHJvY2VzcyBhbmQgcGFyc2UgdGhlIENTVlxuZnVuY3Rpb24gcHJvY2Vzc0NTVihjb250ZW50KSB7XG4gIC8vIFJlbW92ZSBjb21tZW50IGxpbmVzIChsaW5lcyBzdGFydGluZyB3aXRoICMpIFxuICBjb25zdCBsaW5lcyA9IGNvbnRlbnQuc3BsaXQoXCJcXG5cIik7XG4gIGNvbnN0IGZpbHRlcmVkTGluZXMgPSBsaW5lcy5maWx0ZXIobGluZSA9PiAhbGluZS50cmltKCkuc3RhcnRzV2l0aChcIiNcIikpOyAgLy8gPDE+XG4gIGNvbnN0IGNzdkNvbnRlbnQgPSBmaWx0ZXJlZExpbmVzLmpvaW4oXCJcXG5cIik7XG5cbiAgLy8gUGFyc2UgdGhlIENTViBjb250ZW50XG4gIHJldHVybiBkMy5jc3ZQYXJzZShjc3ZDb250ZW50LCBkMy5hdXRvVHlwZSkubWFwKCBcbiAgICBkID0+ICh7IHllYXI6IGQuZGF0ZS5nZXRGdWxsWWVhcigpICAvLyA8Mj5cbiAgICAgICAgICAsIGRheSA6IGQzLnRpbWVEYXkuY291bnQoZDMudGltZVllYXIoZC5kYXRlKSwgZC5kYXRlKSArIDEgLy8gPDM+XG4gICAgICAgICAgLCBhbm9tYWx5OiBkW1wiYW5vXzkxLTIwXCJdIH0pIC8vIDw0PlxuICApXG59XG5cbm1heFllYXIgPSBkMy5tYXgocmF3RGF0YSwgZCA9PiBkLnllYXIpIC8vIDw1PlxubWluWWVhciA9IGQzLm1pbihyYXdEYXRhLCBkID0+IGQueWVhcilcblxuLy8gRGlzcGxheSB0aGUgcGFyc2VkIGRhdGFcbklucHV0cy50YWJsZShyYXdEYXRhKVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC01IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiY29ycmVjdGlvbkRhdGEgPSBkMy50aW1lRGF5XG4gIC5yYW5nZShuZXcgRGF0ZSgyMDI0LCAwLCAxLCAxMiksIG5ldyBEYXRlKDIwMjUsIDAsIDEpLCAxKVxuICAubWFwKCAoZSxpKT0+IChcbiAgICB7IGRhdGUgOiBlXG4gICAgLCB5ZWFyOiAyMDI0XG4gICAgLCBkYXk6IGkgKyAxIFxuICAgICwgY29ycmVjdGlvbjogY29ycmVjdGlvbih7eWVhcjogMjAyNCwgZGF5OiBpICsgMX0pXG4gICAgfVxuICApKSBcblxuLy8gTGluZSBwbG90IG9mIHRoZSBjb3JyZWN0aW9uIGJ5IGRheSBvZiB0aGUgeWVhclxuUGxvdC5wbG90KFxuICB7IG1hcmtzOiBcbiAgICBbIFBsb3QuZG90KGNvcnJlY3Rpb25EYXRhLCBcbiAgICAgIHsgeDogXCJkYXRlXCJcbiAgICAgICwgeTogXCJjb3JyZWN0aW9uXCJcbiAgICAgICwgZmlsbDogXCJibGFja1wiXG4gICAgICAsIHI6IDEgXG4gICAgICB9KVxuICAgICwgUGxvdC5ydWxlWShbLjg4XSwgXG4gICAgICB7c3Ryb2tlOiBcInJlZFwiXG4gICAgICAsIHN0cm9rZU9wYWNpdHk6IDAuNVxuICAgICAgfSlcbiAgICBdXG4gICwgeDoge2xhYmVsOiBcIkRheSBvZiB0aGUgeWVhclwifVxuICAsIHk6IHtsYWJlbDogXCJDb3JyZWN0aW9uXCJ9XG4gICwgd2lkdGg6IDgwMFxuICAsIGhlaWdodDogNDAwXG4gICwgcGFkZGluZzogMC4xXG4gIH0pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTYiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJjb3JyZWN0aW9uID0gKHt5ZWFyLCBkYXl9KSA9PiB7XG4gICAgY29uc3QgZGF5cyA9ICAhKHllYXIgJSA0KSA/IDM2NiA6IDM2NSAvLyA8MT4gXG4gICAgY29uc3QgY29ycmVjdGlvbiA9IDAuODggKyAwLjA1ICogTWF0aC5zaW4oKDIqMy4xNDE1OSAqIChkYXkgLSAwLjUpKSAvIGRheXMpIC8vIDwyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgMC4wNyAqIE1hdGguY29zKCgyKjMuMTQxNTkgKiAoZGF5IC0gMC41KSkgLyBkYXlzKSBcbiAgICByZXR1cm4gTWF0aC5mbG9vciggMTAwICogY29ycmVjdGlvbiApIC8gMTAwXG59XG5cbmNvcnJlY3RlZERhdGEgPSByYXdEYXRhLm1hcCggXG4gICAgZCA9PiAoXG4gICAgICAgIHsgeWVhcjogIGQueWVhclxuICAgICAgICAsIGFub21hbHk6IGQuYW5vbWFseVxuICAgICAgICAsIGNvcnJlY3RlZCA6IGQuYW5vbWFseSArIGNvcnJlY3Rpb24oZCkgfSApKVxuXG4vLyBLZWVwIHRoZSBtaW4gYW5kIG1heCBmb3IgZGlzY3JldGl6YXRpb24gbGF0ZXIgb25cbm9mZnNldCA9IDAuMSAvLyA8Mz5cbm1pbkFub21hbHkgPSBkMy5taW4oY29ycmVjdGVkRGF0YSwgZCA9PiBkLmNvcnJlY3RlZCkgLSBvZmZzZXRcbm1heEFub21hbHkgPSBkMy5tYXgoY29ycmVjdGVkRGF0YSwgZCA9PiBkLmNvcnJlY3RlZCkgKyBvZmZzZXRcbklucHV0cy50YWJsZShjb3JyZWN0ZWREYXRhKVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC03IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibGVuZ3RoID0gKG1heEFub21hbHkgLSBtaW5Bbm9tYWx5KSAqIDEwMFxuaW5kZXhGID0gKHgpID0+IE1hdGgucm91bmQoKHggLSBtaW5Bbm9tYWx5KSAqIDEwMCkgLy8gPDE+IFxuaW5kZXhGXzEgPSAoeCkgPT4gKHggLyAxMDApICsgbWluQW5vbWFseSAvLyA8Mj5cblxuYW5vbWFsaWVzID0gY29ycmVjdGVkRGF0YS5yZWR1Y2UoKGFub21hbGllcywgZCkgPT4ge1xuICAgIGlmIChkLnllYXIgaW4gYW5vbWFsaWVzKSB7XG4gICAgICBhbm9tYWxpZXNbZC55ZWFyXVtpbmRleEYoZC5jb3JyZWN0ZWQpXSArPSAxO1xuICAgIH0gZWxzZSB7XG4gICAgICBhbm9tYWxpZXNbZC55ZWFyXSA9IEFycmF5KGxlbmd0aCkuZmlsbCgwKTtcbiAgICAgIGFub21hbGllc1tkLnllYXJdW2luZGV4RihkLmNvcnJlY3RlZCldID0gMTtcbiAgICB9XG4gICAgcmV0dXJuIGFub21hbGllcztcbiAgfSwgW10pO1xuXG5JbnB1dHMudGFibGUoYW5vbWFsaWVzLmZpbHRlciggKGUsaSkgPT4gaSA+PSAxOTQwKSkgXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTgiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJrZXJuZWxzID0gW1xuICAgICAgWzFdLFxuICAgICAgWzIsIDFdLFxuICAgICAgWzYsIDQsIDFdLFxuICAgICAgWzIwLCAxNSwgNiwgMV0sXG4gICAgICBbNzAsIDU2LCAyOCwgOCwgMV0sXG4gICAgXTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtOSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Imtlcm5lbFZpc3UgPSBrZXJuZWxzLmZsYXRNYXAoIChrZXJuZWwsIGkpID0+IFxuICAgICAga2VybmVsLmZsYXRNYXAoIChlLCBqKSA9PiAoaiA9PSAwKT8gQXJyYXkoZSkuZmlsbCgge2ksIGogfSApIDogQXJyYXkoZSkuZmlsbCggW3tpLCBqIH0sIHtpLCBqOiAtan0gXSkgKSApXG4gICAgICAuZmxhdCgpXG4gICAgICBcblBsb3QucGxvdCh7IFxuICBtYXJrczogW1xuICAgIFBsb3QuYmFyWShrZXJuZWxWaXN1LCBcbiAgICAgIFBsb3QuYmluWCh7eTogXCJwcm9wb3J0aW9uLWZhY2V0XCJ9LCBcbiAgICAgICAgeyB4OiBcImpcIlxuICAgICAgICAsIGZ4OiBcImlcIlxuICAgICAgICAsIHN0cm9rZTogXCJibGFja1wiXG4gICAgICAgICwgZmlsbDogXCJibGFja1wifSkpXG4gICAgICAsIFBsb3QuYXhpc1koe2xhYmVsOiBcIldlaWdodFwiLCB0aWNrRm9ybWF0OiBcIiVcIn0pXG4gXG4gIF1cbiAgLCBncmlkOiB0cnVlXG4gICwgeDpcbiAgICB7IHRpY2tGb3JtYXQ6IChkKSA9PiBkID09IDAgPyBcIjBcIiA6IE1hdGguZmxvb3IoICtkKVxuICAgICwgbGFiZWw6IFwiS2VybmVsIE9mZnNldFwifVxuICAsIGZ4OiBcbiAgICB7IGxhYmVsOiBcIktlcm5lbCBTaXplXCJcbiAgICAsIGFuY2hvcjogXCJib3R0b21cIlxuICB9XG4gICwgeTogXG4gICAge2luc2V0OiA1XG4gICAgLCBsYWJlbDogXCJXZWlnaHRcIlxuICAgICwgdGlja0Zvcm1hdDogXCIlXCJcbiAgfVxufSlcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTAiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJqb3lEYXRhID0gIHtcbiAgLy8gIEdhdXNzaWFuIEJsdXIgc21vb3RoaW5nIFxuICBsZXQgam95RGF0YSA9IFtdO1xuICBmb3IgKGxldCB5ZWFyIGluIGFub21hbGllcykgeyBcbiAgICBjb25zdCBrZXJuZWwgPSBrZXJuZWxzW3Ntb290aEZhY3Rvcl07XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgbGV0IHJlc3VsdCA9IDA7XG4gICAgICBsZXQgd2VpZ2h0ID0gMDtcbiAgICAgIGZvciAobGV0IGogPSAxIC0ga2VybmVsLmxlbmd0aDsgaiA8IGtlcm5lbC5sZW5ndGg7IGorKykge1xuICAgICAgICBpZiAoaSArIGogPj0gMCAmJiBpICsgaiA8IGxlbmd0aCkge1xuICAgICAgICAgIGNvbnN0IGFic0ogPSBNYXRoLmFicyhqKTtcbiAgICAgICAgICByZXN1bHQgKz0gYW5vbWFsaWVzW3llYXJdW2kgKyBqXSAqIGtlcm5lbFthYnNKXTsgLy8gPDE+XG4gICAgICAgICAgd2VpZ2h0ICs9IGtlcm5lbFthYnNKXTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgam95RGF0YS5wdXNoKHsgXG4gICAgICAgIHllYXI6IHllYXIsXG4gICAgICAgIGFub21hbHk6IGluZGV4Rl8xKGkpLCBcbiAgICAgICAgY291bnQ6IHJlc3VsdCAvIHdlaWdodCxcbiAgICAgICAgaGVpZ2h0OiByZXN1bHQgLyB3ZWlnaHQgKyAobWF4WWVhciAtIHllYXIpICogeWVhck9mZnNldCwgLy8gPDI+XG4gICAgICAgIHJlZmVyZW5jZTogKG1heFllYXIgLSB5ZWFyKSAqIHllYXJPZmZzZXQsXG4gICAgICB9KTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGpveURhdGEuZmlsdGVyKChkKSA9PiBkLnllYXIgIT0gbWF4WWVhcik7IC8vIDwzPlxufVxuXG5qb3lEYXRhXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTExIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoic2VyaWFsaXplID0ge1xuICBjb25zdCB4bWxucyA9IFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC94bWxucy9cIjtcbiAgY29uc3QgeGxpbmtucyA9IFwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGlua1wiO1xuICBjb25zdCBzdmducyA9IFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIjtcbiAgcmV0dXJuIGZ1bmN0aW9uIHNlcmlhbGl6ZShzdmcpIHtcbiAgICBzdmcgPSBzdmcuY2xvbmVOb2RlKHRydWUpO1xuICAgIGNvbnN0IGZyYWdtZW50ID0gd2luZG93LmxvY2F0aW9uLmhyZWYgKyBcIiNcIjtcbiAgICBjb25zdCB3YWxrZXIgPSBkb2N1bWVudC5jcmVhdGVUcmVlV2Fsa2VyKHN2ZywgTm9kZUZpbHRlci5TSE9XX0VMRU1FTlQpO1xuICAgIHdoaWxlICh3YWxrZXIubmV4dE5vZGUoKSkge1xuICAgICAgZm9yIChjb25zdCBhdHRyIG9mIHdhbGtlci5jdXJyZW50Tm9kZS5hdHRyaWJ1dGVzKSB7XG4gICAgICAgIGlmIChhdHRyLnZhbHVlLmluY2x1ZGVzKGZyYWdtZW50KSkge1xuICAgICAgICAgIGF0dHIudmFsdWUgPSBhdHRyLnZhbHVlLnJlcGxhY2UoZnJhZ21lbnQsIFwiI1wiKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBzdmcuc2V0QXR0cmlidXRlTlMoeG1sbnMsIFwieG1sbnNcIiwgc3ZnbnMpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGVOUyh4bWxucywgXCJ4bWxuczp4bGlua1wiLCB4bGlua25zKTtcbiAgICBjb25zdCBzZXJpYWxpemVyID0gbmV3IHdpbmRvdy5YTUxTZXJpYWxpemVyO1xuICAgIGNvbnN0IHN0cmluZyA9IHNlcmlhbGl6ZXIuc2VyaWFsaXplVG9TdHJpbmcoc3ZnKTtcbiAgICByZXR1cm4gbmV3IEJsb2IoW3N0cmluZ10sIHt0eXBlOiBcImltYWdlL3N2Zyt4bWxcIn0pO1xuICB9O1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdvcGFjaXR5JykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3llYXJPZmZzZXQnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnc21vb3RoRmFjdG9yJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ2Zyb21Cb3R0b20nKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnY29sb3InKSJ9XX0=
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../projects/DataViz";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "../..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/dhmmasson\.github\.io");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="dhmmasson/dhmmasson.github.io" issue-term="title" theme="boxy-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 © 2024 Dimitri Masson
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 Built with Quarto, 
  </li>  
    <li class="nav-item">
 Source code available on GitHub
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/dhmmasson/dhmmasson.github.io">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>